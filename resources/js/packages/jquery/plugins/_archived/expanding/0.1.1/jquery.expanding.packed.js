(function(a){if(typeof define==='function'&&define.amd){define(['jquery'],a)}else{a(jQuery)}}(function($){var d=function(a,b){d._registry.push(this);this.$textarea=a;this.$textCopy=$("<span />");this.$clone=$("<pre class='expanding-clone'><br /></pre>").prepend(this.$textCopy);this._resetStyles();this._setCloneStyles();this._setTextareaStyles();a.wrap($("<div class='expanding-wrapper' style='position:relative' />")).after(this.$clone);this.attach();this.update();if(b.update)a.bind("update.expanding",b.update)};d._registry=[];d.getExpandingInstance=function(b){var c=$.map(d._registry,function(a){return a.$textarea[0]}),index=$.inArray(b,c);return index>-1?d._registry[index]:null};var e=(function(){var v=-1;if(navigator.appName==="Microsoft Internet Explorer"){var a=navigator.userAgent;var b=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})");if(b.exec(a)!==null)v=parseFloat(RegExp.$1)}return v})();var f="oninput"in document.createElement("input")&&e!==9;d.prototype={attach:function(){var a='input.expanding change.expanding',_this=this;if(!f)a+=' keyup.expanding';this.$textarea.bind(a,function(){_this.update()})},update:function(){this.$textCopy.text(this.$textarea.val().replace(/\r\n/g,"\n"));this.$textarea.triggerHandler("update.expanding")},destroy:function(){this.$clone.remove();this.$textarea.unwrap().attr('style',this._oldTextareaStyles||'');delete this._oldTextareaStyles;var a=$.inArray(this,d._registry);if(a>-1)d._registry.splice(a,1);this.$textarea.unbind('input.expanding change.expanding keyup.expanding update.expanding')},_resetStyles:function(){this._oldTextareaStyles=this.$textarea.attr('style');this.$textarea.add(this.$clone).css({margin:this.$textarea.css('margin'),webkitBoxSizing:"border-box",mozBoxSizing:"border-box",boxSizing:"border-box"})},_setCloneStyles:function(){var a={display:'block',border:'0 solid',visibility:'hidden',minHeight:this.$textarea.outerHeight()};if(this.$textarea.attr("wrap")==="off")a.overflowX="scroll";else a.whiteSpace="pre-wrap";this.$clone.css(a);this._copyTextareaStylesToClone()},_copyTextareaStylesToClone:function(){var c=this,properties=['lineHeight','textDecoration','letterSpacing','fontSize','fontFamily','fontStyle','fontWeight','textTransform','textAlign','direction','wordSpacing','fontSizeAdjust','wordWrap','word-break','borderLeftWidth','borderRightWidth','borderTopWidth','borderBottomWidth','paddingLeft','paddingRight','paddingTop','paddingBottom','maxHeight'];$.each(properties,function(i,a){var b=c.$textarea.css(a);if(c.$clone.css(a)!==b){c.$clone.css(a,b);if(a==='maxHeight'&&b!=='none'){c.$clone.css('overflow','hidden')}}})},_setTextareaStyles:function(){this.$textarea.css({position:"absolute",top:0,left:0,height:"100%",resize:"none",overflow:"auto"})}};$.expanding=$.extend({autoInitialize:true,initialSelector:"textarea.expanding",opts:{update:function(){}}},$.expanding||{});$.fn.expanding=function(o){if(o==="destroy"){this.each(function(){var a=d.getExpandingInstance(this);if(a)a.destroy()});return this}if(o==="active"){return!!this.filter(function(){return!!d.getExpandingInstance(this)}).length}var b=$.extend({},$.expanding.opts,o);this.filter("textarea").each(function(){var a=this.offsetWidth>0||this.offsetHeight>0,initialized=d.getExpandingInstance(this);if(a&&!initialized)new d($(this),b);else{if(!a)_warn("ExpandingTextareas: attempt to initialize an invisible textarea. Call expanding() again once it has been inserted into the page and/or is visible.");if(initialized)_warn("ExpandingTextareas: attempt to initialize a textarea that has already been initialized. Subsequent calls are ignored.")}});return this};function _warn(a){if(window.console&&console.warn)console.warn(a)}$(function(){if($.expanding.autoInitialize){$($.expanding.initialSelector).expanding()}})}));
