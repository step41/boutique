(function($){var d={className:'autosizejs',append:"",callback:false},hidden='hidden',borderBox='border-box',lineHeight='lineHeight',copy='<textarea tabindex="-1" style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; border:0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden;"/>',copyStyle=['fontFamily','fontSize','fontWeight','fontStyle','letterSpacing','textTransform','wordSpacing','textIndent'],oninput='oninput',onpropertychange='onpropertychange',mirrored,mirror=$(copy).data('autosize',true)[0];mirror.style.lineHeight='99px';if($(mirror).css(lineHeight)==='99px'){copyStyle.push(lineHeight)}mirror.style.lineHeight='';$.fn.autosize=function(c){c=$.extend({},d,c||{});if(mirror.parentNode!==document.body){$(document.body).append(mirror)}return this.each(function(){var b=this,$ta=$(b),minHeight=$ta.height(),maxHeight=parseInt($ta.css('maxHeight'),10),active,resize,boxOffset=0,value=b.value,callback=$.isFunction(c.callback);if($ta.data('autosize')){return}if($ta.css('box-sizing')===borderBox||$ta.css('-moz-box-sizing')===borderBox||$ta.css('-webkit-box-sizing')===borderBox){boxOffset=$ta.outerHeight()-$ta.height()}resize=$ta.css('resize')==='none'?'none':'horizontal';$ta.css({overflow:hidden,overflowY:hidden,wordWrap:'break-word',resize:resize}).data('autosize',true);maxHeight=maxHeight&&maxHeight>0?maxHeight:9e4;function initMirror(){mirrored=b;mirror.className=c.className;$.each(copyStyle,function(i,a){mirror.style[a]=$ta.css(a)})}function adjust(){var a,overflow,original;if(mirrored!==b){initMirror()}if(!active){active=true;mirror.value=b.value+c.append;mirror.style.overflowY=b.style.overflowY;original=parseInt(b.style.height,10);mirror.style.width=$ta.width()+'px';mirror.scrollTop=0;mirror.scrollTop=9e4;a=mirror.scrollTop;if(a>maxHeight){a=maxHeight;overflow='scroll'}else if(a<minHeight){a=minHeight}a+=boxOffset;b.style.overflowY=overflow||hidden;if(original!==a){b.style.height=a+'px';if(callback){c.callback.call(b)}}setTimeout(function(){active=false},1)}}if(onpropertychange in b){if(oninput in b){b[oninput]=b.onkeyup=adjust}else{b[onpropertychange]=adjust}}else{b[oninput]=adjust;b.value='';b.value=value}$(window).resize(adjust);$ta.bind('autosize',adjust);adjust()})}}(window.jQuery||window.Zepto));
