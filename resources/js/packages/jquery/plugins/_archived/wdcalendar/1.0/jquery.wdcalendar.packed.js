;(function($){var P=new Array(i18n.xgcalendar.dateformat.sun,i18n.xgcalendar.dateformat.mon,i18n.xgcalendar.dateformat.tue,i18n.xgcalendar.dateformat.wed,i18n.xgcalendar.dateformat.thu,i18n.xgcalendar.dateformat.fri,i18n.xgcalendar.dateformat.sat);var Q=new Array(i18n.xgcalendar.dateformat.jan,i18n.xgcalendar.dateformat.feb,i18n.xgcalendar.dateformat.mar,i18n.xgcalendar.dateformat.apr,i18n.xgcalendar.dateformat.may,i18n.xgcalendar.dateformat.jun,i18n.xgcalendar.dateformat.jul,i18n.xgcalendar.dateformat.aug,i18n.xgcalendar.dateformat.sep,i18n.xgcalendar.dateformat.oct,i18n.xgcalendar.dateformat.nov,i18n.xgcalendar.dateformat.dec);if(!R||typeof(R)!="function"){var R=function(a){var b=new Object();if(a.constructor==Object){b=new a.constructor()}else{b=new a.constructor(a.valueOf())}for(var c in a){if(b[c]!=a[c]){if(typeof(a[c])=='object'){b[c]=R(a[c])}else{b[c]=a[c]}}}b.toString=a.toString;b.valueOf=a.valueOf;return b}}if(!S||typeof(S)!="function"){var S=function(a){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"w":"0123456".indexOf(this.getDay()),"W":P[this.getDay()],"L":Q[this.getMonth()]};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in o){if(new RegExp("("+k+")").test(a))a=a.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}return a}}if(!T||typeof(U)!="function"){var T=function(a,b,c){b=parseInt(b);var d;if(typeof(c)=="string"){d=c.split(/\D/);eval("var date = new Date("+d.join(",")+")")}if(typeof(c)=="object"){d=new Date(c.toString())}switch(a){case"y":d.setFullYear(d.getFullYear()+b);break;case"m":d.setMonth(d.getMonth()+b);break;case"d":d.setDate(d.getDate()+b);break;case"w":d.setDate(d.getDate()+7*b);break;case"h":d.setHours(d.getHours()+b);break;case"n":d.setMinutes(d.getMinutes()+b);break;case"s":d.setSeconds(d.getSeconds()+b);break;case"l":d.setMilliseconds(d.getMilliseconds()+b);break}return d}}if(!U||typeof(U)!="function"){var U=function(a,b,c){switch(a){case"d":case"w":b=new Date(b.getFullYear(),b.getMonth(),b.getDate());c=new Date(c.getFullYear(),c.getMonth(),c.getDate());break;case"h":b=new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours());c=new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours());break;case"n":b=new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes());c=new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes());break;case"s":b=new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds());c=new Date(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds());break}var d=b.getTime(),t2=c.getTime();var e=NaN;switch(a){case"y":e=c.getFullYear()-b.getFullYear();break;case"m":e=(c.getFullYear()-b.getFullYear())*12+c.getMonth()-b.getMonth();break;case"d":e=Math.floor(t2/86400000)-Math.floor(d/86400000);break;case"w":e=Math.floor((t2+345600000)/(604800000))-Math.floor((d+345600000)/(604800000));break;case"h":e=Math.floor(t2/3600000)-Math.floor(d/3600000);break;case"n":e=Math.floor(t2/60000)-Math.floor(d/60000);break;case"s":e=Math.floor(t2/1000)-Math.floor(d/1000);break;case"l":e=t2-d;break}return e}}if($.fn.noSelect==undefined){$.fn.noSelect=function(p){if(p==null)prevent=true;else prevent=p;if(prevent){return this.each(function(){if($.browser.msie||$.browser.safari)$(this).bind('selectstart',function(){return false});else if($.browser.mozilla){$(this).css('MozUserSelect','none');$('body').trigger('focus')}else if($.browser.opera)$(this).bind('mousedown',function(){return false});else $(this).attr('unselectable','on')})}else{return this.each(function(){if($.browser.msie||$.browser.safari)$(this).unbind('selectstart');else if($.browser.mozilla)$(this).css('MozUserSelect','inherit');else if($.browser.opera)$(this).unbind('mousedown');else $(this).removeAttr('unselectable','on')})}}}$.fn.bcalendar=function(E){var F={view:"week",weekstartday:1,theme:0,height:false,url:"",eventItems:[],method:"POST",showday:new Date(),onBeforeRequestData:false,onAfterRequestData:false,onRequestDataError:false,onWeekOrMonthToDay:false,quickAddHandler:false,quickAddUrl:"",quickUpdateUrl:"",quickDeleteUrl:"",autoload:false,readonly:false,extParam:[],enableDrag:true,loadDateR:[]};var G=$("#gridEvent");if(G.length==0){G=$("<div id='gridEvent' style='display:none;'></div>").appendTo(document.body)}var I=$(this);E=$.extend(F,E);if(E.quickUpdateUrl==null||E.quickUpdateUrl==""){E.enableDrag=false}var J="<DIV id='event_preview_${eventid}' style=\"cursor:pointer; WIDTH:${width};top:${top};left:${left};\" title=\"${title}\" class=\"chip chip${i} ${drag}\"><div class=\"dhdV\" style=\"display:none\">${data}</div><DIV style=\"BORDER-BOTTOM-COLOR:${bdcolor}\" class=ct>&nbsp;</DIV><DL style=\"BORDER-BOTTOM-COLOR:${bdcolor}; BACKGROUND-COLOR:${bgcolor1}; BORDER-TOP-COLOR: ${bdcolor}; HEIGHT: ${height}px; BORDER-RIGHT-COLOR:${bdcolor}; BORDER-LEFT-COLOR:${bdcolor}\"><DT style=\"BACKGROUND-COLOR:${bgcolor2}\">${starttime} - ${endtime} ${icon}</DT><DD><SPAN>${content}</SPAN></DD><DIV class='resizer' style='display:${redisplay}'><DIV class=rszr_icon>&nbsp;</DIV></DIV></DL><DIV style=\"BORDER-BOTTOM-COLOR:${bdcolor}; BACKGROUND-COLOR:${bgcolor1}; BORDER-TOP-COLOR: ${bdcolor}; BORDER-RIGHT-COLOR: ${bdcolor}; BORDER-LEFT-COLOR:${bdcolor}\" class=cb1>&nbsp;</DIV><DIV style=\"BORDER-BOTTOM-COLOR:${bdcolor}; BORDER-TOP-COLOR:${bdcolor}; BORDER-RIGHT-COLOR:${bdcolor}; BORDER-LEFT-COLOR:${bdcolor}\" class=cb2>&nbsp;</DIV></DIV>";var K='<div class="rb-o ${eclass}" id="${id}" title="${title}" style="color:${color};"><div class="dhdV" style="display:none">${data}</div><div class="${extendClass} rb-m" style="background-color:${color}">${extendHTML}<div class="rb-i">${content}</div></div></div>';var L=[31,28,31,30,31,30,31,31,30,31,30,31];var M="<div class='drag-lasso' style='left:${left}px;top:${top}px;width:${width}px;height:${height}px;'>&nbsp;</div>";var N;var O;clearcontainer();if(!E.height){E.height=document.documentElement.clientHeight}I.css("overflow-y","visible").height(E.height-8);if(E.url&&E.autoload){populate()}else{render();var d=getRdate();pushER(d.start,d.end)}function clearcontainer(){I.empty()}function getRdate(){return{start:E.vstart,end:E.vend}}function pushER(a,b){var c=E.loadDateR.length;if(!b){b=a}if(c==0){E.loadDateR.push({startdate:a,enddate:b})}else{for(var i=0;i<c;i++){var d=E.loadDateR[i];var e=U("d",a,d.startdate);if(e==0||e==1){if(d.enddate<b){d.enddate=b}break}else if(e>1){var f=U("d",b,d.startdate);if(f>1){E.loadDateR.splice(0,0,{startdate:a,enddate:b})}else{d.startdate=a;if(d.enddate<b){d.enddate=b}}break}else{var g=U("d",b,d.startdate);if(d.enddate<b){if(g<1){d.enddate=b;break}else{if(i==c-1){E.loadDateR.push({startdate:a,enddate:b})}}}}}c=E.loadDateR.length;if(c>1){for(var i=0;i<c-1;){var h=E.loadDateR[i];var f=E.loadDateR[i+1];var j=U("d",f.startdate,h.enddate);if(j<=1){h.startdate=f.startdate>h.startdate?h.startdate:f.startdate;h.enddate=f.enddate>h.enddate?f.enddate:h.enddate;E.loadDateR.splice(i+1,1);c--;continue}i++}}}}function render(){var a=new Date(E.showday.getFullYear(),E.showday.getMonth(),E.showday.getDate());var b=E.eventItems;var c={view:E.view,weekstartday:E.weekstartday,theme:E.theme};if(E.view=="day"||E.view=="week"){var d=$("#dvtec");if(d.length>0){E.scoll=d.attr("scrollTop")}}switch(E.view){case"day":BuildDaysAndWeekView(a,1,b,c);break;case"week":BuildDaysAndWeekView(a,7,b,c);break;case"month":BuildMonthView(a,b,c);break;default:alert(i18n.xgcalendar.no_implement);break}initevents(E.view);ResizeView()}function BuildDaysAndWeekView(a,l,b,c){var d=[];if(l==1){var e=S.call(a,i18n.xgcalendar.dateformat.Md);d.push({display:e,date:a,day:a.getDate(),year:a.getFullYear(),month:a.getMonth()+1});E.datestrshow=CalDateShow(d[0].date);E.vstart=d[0].date;E.vend=d[0].date}else{var w=0;if(l==7){w=c.weekstartday-a.getDay();if(w>0)w=w-7}var f;for(var i=w,j=0;j<l;i=i+1,j++){f=T("d",i,a);var e=S.call(f,i18n.xgcalendar.dateformat.Md);d.push({display:e,date:f,day:f.getDate(),year:f.getFullYear(),month:f.getMonth()+1})}E.vstart=d[0].date;E.vend=d[l-1].date;E.datestrshow=CalDateShow(d[0].date,d[l-1].date)}var g=[];var h=[];var k=PropareEvents(d,b,g,h);var m=[];m.push("<div id=\"dvwkcontaienr\" class=\"wktopcontainer\">");m.push("<table class=\"wk-top\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">");BuildWT(m,d,g,k);m.push("</table>");m.push("</div>");m.push("<div id=\"dvtec\"  class=\"scolltimeevent\"><table style=\"table-layout: fixed;",jQuery.browser.msie?"":"width:100%","\" cellspacing=\"0\" cellpadding=\"0\"><tbody><tr><td>");m.push("<table style=\"height: 1008px\" id=\"tgTable\" class=\"tg-timedevents\" cellspacing=\"0\" cellpadding=\"0\"><tbody>");BuildDayScollEventContainer(m,d,h);m.push("</tbody></table></td></tr></tbody></table></div>");I.html(m.join(""));m=null}function BuildMonthView(a,b,c){var d="<div id='cal-month-cc' class='cc'><div id='cal-month-cc-header'><div class='cc-close' id='cal-month-closebtn'></div><div id='cal-month-cc-title' class='cc-title'></div></div><div id='cal-month-cc-body' class='cc-body'><div id='cal-month-cc-content' class='st-contents'><table class='st-grid' cellSpacing='0' cellPadding='0'><tbody></tbody></table></div></div></div>";var e=[];e.push(d);e.push("<div id=\"mvcontainer\" class=\"mv-container\">");e.push("<table id=\"mvweek\" class=\"mv-daynames-table\" cellSpacing=\"0\" cellPadding=\"0\"><tbody><tr>");for(var i=c.weekstartday,j=0;j<7;i++,j++){if(i>6)i=0;var p={dayname:P[i]};e.push("<th class=\"mv-dayname\" title=\"",P[i],"\">",P[i],"")}e.push("</tr></tbody></table>");e.push("</div>");var f=GetMonthViewBodyHeight()-GetMonthViewHeaderHeight();e.push("<div id=\"mvEventContainer\" class=\"mv-event-container\" style=\"height:",f,"px;","\">");BuilderMonthBody(e,a,c.weekstartday,b,f);e.push("</div>");I.html(e.join(""));e=null;$("#cal-month-closebtn").click(closeCc)}function closeCc(){$("#cal-month-cc").css("visibility","hidden")}function PropareEvents(a,b,c,d){var l=a.length;var e=b.length;var f=[];var g=c;var h=d;for(var j=0;j<e;j++){var m=b[j][2];var n=b[j][3];var s={};s.event=b[j];s.day=m.getDate();s.year=m.getFullYear();s.month=m.getMonth()+1;s.allday=b[j][4]==1;s.crossday=b[j][5]==1;s.reevent=b[j][6]==1;s.daystr=[s.year,s.month,s.day].join("/");s.st={};s.st.hour=m.getHours();s.st.minute=m.getMinutes();s.st.p=s.st.hour*60+s.st.minute;s.et={};s.et.hour=n.getHours();s.et.minute=n.getMinutes();s.et.p=s.et.hour*60+s.et.minute;f.push(s)}var o=0;for(var i=0;i<l;i++){var q=a[i];h[i]=[];g[i]=[];q.daystr=q.year+"/"+q.month+"/"+q.day;for(var j=0;j<f.length;j++){if(!f[j].crossday&&!f[j].allday){if(q.daystr==f[j].daystr)h[i].push(f[j])}else{if(q.daystr==f[j].daystr){g[i].push(f[j]);o++}else{if(i==0&&q.date>=f[j].event[2]&&q.date<=f[j].event[3]){g[i].push(f[j]);o++}}}}}var r=a[l-1].date;for(var i=0;i<l;i++){var u=g[i];if(u.length>0){for(var j=0;j<u.length;j++){var v=U("d",r,u[j].event[3])>0?r:u[j].event[3];u[j].colSpan=U("d",a[i].date,v)+1}}u=null}for(var i=0;i<l;i++){var u=h[i];if(u.length>0){var x=[];var y=[];var D=[];var w=u.length;var z;for(var j=0;j<w;++j){var A=u[j];for(var B=A.st.p,z=0;y[z]>B;)z++;A.PO=z;A.ne=[];y[z]=A.et.p||1440;x[z]=A;if(!D[z]){D[z]=[]}D[z].push(A);if(z!=0){A.pe=[x[z-1]];x[z-1].ne.push(A)}for(z=z+1;y[z]<=B;)z++;if(x[z]){var k=x[z];A.ne.push(k);k.pe.push(A)}A.width=1/(A.PO+1);A.left=1-A.width}var k=Array.prototype.concat.apply([],D);x=y=D=null;var t=k.length;for(var y=t;y--;){var H=1;var B=0;var x=k[y];for(var D=x.ne.length;D--;){var z=x.ne[D];B=Math.max(B,z.VL);H=Math.min(H,z.left)}x.VL=B+1;x.width=H/(x.PO+1);x.left=H-x.width}for(var y=0;y<t;y++){var x=k[y];x.left=0;if(x.pe)for(var D=x.pe.length;D--;){var H=x.pe[D];x.left=Math.max(x.left,H.left+H.width)}var p=(1-x.left)/x.VL;x.width=Math.max(x.width,p);x.aQ=Math.min(1-x.left,x.width+0.7*p)}u=null;h[i]=k}}return o}function BuildWT(a,b,c,d){a.push("<tr>","<th width=\"60\" rowspan=\"3\">&nbsp;</th>");for(var i=0;i<b.length;i++){var f,title,cl;if(b.length==1){f="";title="";cl=""}else{f="";title=i18n.xgcalendar.to_date_view;cl="wk-daylink"}a.push("<th abbr='",S.call(b[i].date,i18n.xgcalendar.dateformat.fulldayvalue),"' class='gcweekname' scope=\"col\"><div title='",title,"' ",f," class='wk-dayname'><span class='",cl,"'>",b[i].display,"</span></div></th>")}a.push("<th width=\"16\" rowspan=\"3\">&nbsp;</th>");a.push("</tr>");a.push("<tr>");a.push("<td class=\"wk-allday\"");if(b.length>1){a.push(" colSpan='",b.length,"'")}a.push("><div id=\"weekViewAllDaywk\" ><table class=\"st-grid\" cellpadding=\"0\" cellspacing=\"0\"><tbody>");if(d==0){a.push("<tr>");for(var i=0;i<b.length;i++){a.push("<td class=\"st-c st-s\""," ch='qkadd' abbr='",S.call(b[i].date,"yyyy-M-d"),"' axis='00:00'>&nbsp;</td>")}a.push("</tr>")}else{var l=c.length;var g=0;var x=[];for(var j=0;j<l;j++){x.push(0)}for(var j=0;g<d;j++){a.push("<tr>");for(var h=0;h<l;){var e=c[h][x[h]];a.push("<td class='st-c");if(e){x[h]=x[h]+1;a.push("'");var t=BuildMonthDayEvent(e,b[h].date,l-h);if(e.colSpan>1){a.push(" colSpan='",e.colSpan,"'");h+=e.colSpan}else{h++}a.push(" ch='show'>",t);t=null;g++}else{a.push(" st-s' ch='qkadd' abbr='",S.call(b[h].date,i18n.xgcalendar.dateformat.fulldayvalue),"' axis='00:00'>&nbsp;");h++}a.push("</td>")}a.push("</tr>")}a.push("<tr>");for(var h=0;h<l;h++){a.push("<td class='st-c st-s' ch='qkadd' abbr='",S.call(b[h].date,i18n.xgcalendar.dateformat.fulldayvalue),"' axis='00:00'>&nbsp;</td>")}a.push("</tr>")}a.push("</tbody></table></div></td></tr>");a.push("<tr>");a.push("<td style=\"height: 5px;\"");if(b.length>1){a.push(" colSpan='",b.length,"'")}a.push("></td>");a.push("</tr>")}function BuildDayScollEventContainer(a,b,c){a.push("<tr>");a.push("<td style='width:60px;'></td>");a.push("<td");if(b.length>1){a.push(" colSpan='",b.length,"'")}a.push("><div id=\"tgspanningwrapper\" class=\"tg-spanningwrapper\"><div style=\"font-size: 20px\" class=\"tg-hourmarkers\">");for(var i=0;i<24;i++){a.push("<div class=\"tg-dualmarker\"></div>")}a.push("</div></div></td></tr>");a.push("<tr>");a.push("<td style=\"width: 60px\" class=\"tg-times\">");var d=new Date();var h=d.getHours();var m=d.getMinutes();var e=gP(h,m)-4;a.push("<div id=\"tgnowptr\" class=\"tg-nowptr\" style=\"left:0px;top:",e,"px\"></div>");var f="";for(var i=0;i<24;i++){f=fomartTimeShow(i);a.push("<div style=\"height: 41px\" class=\"tg-time\">",f,"</div>")}a.push("</td>");var l=b.length;for(var i=0;i<l;i++){a.push("<td class=\"tg-col\" ch='qkadd' abbr='",S.call(b[i].date,i18n.xgcalendar.dateformat.fulldayvalue),"'>");var g=S.call(b[i].date,"yyyyMMdd")==S.call(new Date(),"yyyyMMdd");if(g){a.push("<div style=\"margin-bottom: -1008px; height:1008px\" class=\"tg-today\">&nbsp;</div>")}a.push("<div  style=\"margin-bottom: -1008px; height: 1008px\" id='tgCol",i,"' class=\"tg-col-eventwrapper\">");BuildEvents(a,c[i],b[i]);a.push("</div>");a.push("<div class=\"tg-col-overlaywrapper\" id='tgOver",i,"'>");if(g){var j=e+4;a.push("<div id=\"tgnowmarker\" class=\"tg-hourmarker tg-nowmarker\" style=\"left:0px;top:",j,"px\"></div>")}a.push("</div>");a.push("</td>")}a.push("</tr>")}function BuildEvents(a,b,d){for(var i=0;i<b.length;i++){var c;if(b[i].event[7]&&b[i].event[7]>=0){c=tc(b[i].event[7])}else{c=tc()}var e=BuildDayEvent(c,b[i],i);a.push(e)}}function getTitle(a){var b,locationshow,attendsshow,eventshow;var c=a[4]!=1;eventshow=a[1];var d=getymformat(a[2],null,c,true);var e=getymformat(a[3],a[2],c,true);b=S.call(a[2],d)+" - "+S.call(a[3],e);locationshow=(a[9]!=undefined&&a[9]!="")?a[9]:i18n.xgcalendar.i_undefined;attendsshow=(a[10]!=undefined&&a[10]!="")?a[10]:"";var f=[];if(a[4]==1){f.push("["+i18n.xgcalendar.allday_event+"]",$.browser.mozilla?"":"\r\n")}else{if(a[5]==1){f.push("["+i18n.xgcalendar.repeat_event+"]",$.browser.mozilla?"":"\r\n")}}f.push(i18n.xgcalendar.time+":",b,$.browser.mozilla?"":"\r\n",i18n.xgcalendar.event+":",eventshow,$.browser.mozilla?"":"\r\n",i18n.xgcalendar.location+":",locationshow);if(attendsshow!=""){f.push($.browser.mozilla?"":"\r\n",i18n.xgcalendar.participant+":",attendsshow)}return f.join("")}function BuildDayEvent(a,e,b){var p={bdcolor:a[0],bgcolor2:a[0],bgcolor1:a[2],width:"70%",icon:"",title:"",eventid:"",data:""};p.starttime=pZero(e.st.hour)+":"+pZero(e.st.minute);p.endtime=pZero(e.et.hour)+":"+pZero(e.et.minute);p.eventid=e.event[0];p.content=e.event[1];p.title=getTitle(e.event);p.data=e.event.join("$");var c=[];c.push("<I class=\"cic cic-tmr\">&nbsp;</I>");if(e.reevent){c.push("<I class=\"cic cic-spcl\">&nbsp;</I>")}p.icon=c.join("");var d=gP(e.st.hour,e.st.minute);var f=gP(e.et.hour,e.et.minute);p.top=d+"px";p.left=(e.left*100)+"%";p.width=(e.aQ*100)+"%";p.height=(f-d-4);p.i=b;if(E.enableDrag&&e.event[8]==1){p.drag="drag";p.redisplay="block"}else{p.drag="";p.redisplay="none"}var g=Tp(J,p);p=null;return g}function GetMonthViewBodyHeight(){return E.height}function GetMonthViewHeaderHeight(){return 21}function BuilderMonthBody(a,c,d,e,f){var g=new Date(c.getFullYear(),c.getMonth(),1);var h=d-g.getDay();var l=c.getMonth();if(h>0){h-=7}var m=T("d",h,g);var n=T("d",34,m);var q=5;if(n.getFullYear()==c.getFullYear()&&n.getMonth()==c.getMonth()&&n.getDate()<L[l]){n=T("d",7,n);q=6}E.vstart=m;E.vend=n;E.datestrshow=CalDateShow(m,n);f=f-18*q;var r=f/q;var s=parseInt(r/21);if(r%21>15){s++}var p=100/q;var t=[];var u=formartEventsInHashtable(e,d,7,m,n);var B=[];var C=[];for(var j=0;j<q;j++){var k=0;t[j]=b=[];for(var i=0;i<7;i++){var v=T("d",j*7+i,m);C[j*7+i]=v;var w=S.call(v,i18n.xgcalendar.dateformat.fulldaykey);b[i]=u[w];if(b[i]&&b[i].length>0){k+=b[i].length}}B[j]=k}G.data("mvdata",t);for(var j=0;j<q;j++){a.push("<div id='mvrow_",j,"' style=\"HEIGHT:",p,"%; TOP:",p*j,"%\"  class=\"month-row\">");a.push("<table class=\"st-bg-table\" cellSpacing=\"0\" cellPadding=\"0\"><tbody><tr>");var x=B[j];for(var i=0;i<7;i++){var y=C[j*7+i];a.push("<td abbr='",S.call(y,i18n.xgcalendar.dateformat.fulldayvalue),"' ch='qkadd' axis='00:00' title=''");if(S.call(y,"yyyyMMdd")==S.call(new Date(),"yyyyMMdd")){a.push(" class=\"st-bg st-bg-today\">")}else{a.push(" class=\"st-bg\">")}a.push("&nbsp;</td>")}a.push("</tr></tbody></table>");a.push("<table class=\"st-grid\" cellpadding=\"0\" cellspacing=\"0\"><tbody>");a.push("<tr>");var z="<td class=\"st-dtitle${titleClass}\" ch='qkadd' abbr='${abbr}' axis='00:00' title=\"${title}\"><span class='monthdayshow'>${dayshow}</span></a></td>";for(var i=0;i<7;i++){var o={titleClass:"",dayshow:""};var y=C[j*7+i];if(S.call(y,"yyyyMMdd")==S.call(new Date(),"yyyyMMdd")){o.titleClass=" st-dtitle-today"}if(y.getMonth()!=l){o.titleClass=" st-dtitle-nonmonth"}o.title=S.call(y,i18n.xgcalendar.dateformat.fulldayshow);if(y.getDate()==1){if(y.getMonth==0){o.dayshow=S.call(y,i18n.xgcalendar.dateformat.fulldayshow)}else{o.dayshow=S.call(y,i18n.xgcalendar.dateformat.Md3)}}else{o.dayshow=y.getDate()}o.abbr=S.call(y,i18n.xgcalendar.dateformat.fulldayvalue);a.push(Tp(z,o))}a.push("</tr>");var A=C[j*7];BuildMonthRow(a,t[j],x,s,A);a.push("</tbody></table>");a.push("</div>")}t=B=C=u=null}function formartEventsInHashtable(a,b,c,e,g){var h=new Object();var l=a.length;for(var i=0;i<l;i++){var j=a[i][2];var k=a[i][3];var m=U("d",j,k);var s={};s.event=a[i];s.day=j.getDate();s.year=j.getFullYear();s.month=j.getMonth()+1;s.allday=a[i][4]==1;s.crossday=a[i][5]==1;s.reevent=a[i][6]==1;s.daystr=s.year+"/"+s.month+"/"+s.day;s.st={};s.st.hour=j.getHours();s.st.minute=j.getMinutes();s.st.p=s.st.hour*60+s.st.minute;s.et={};s.et.hour=k.getHours();s.et.minute=k.getMinutes();s.et.p=s.et.hour*60+s.et.minute;if(m>0){if(j<e){j=e}if(k>g){k=g}var f=b-j.getDay();if(f>0){f-=c}var n=T("d",f,j);for(;n<=k;j=n=T("d",c,n)){var d=R(s);var o=S.call(j,i18n.xgcalendar.dateformat.fulldaykey);var x=U("d",n,k);if(h[o]==null){h[o]=[]}d.colSpan=(x>=c)?c-U("d",n,j):U("d",j,k)+1;h[o].push(d);d=null}}else{var o=S.call(a[i][2],i18n.xgcalendar.dateformat.fulldaykey);if(h[o]==null){h[o]=[]}s.colSpan=1;h[o].push(s)}s=null}return h}function BuildMonthRow(a,b,c,d,f){var x=[];var y=[];var z=[];var g=[];var l=b.length;var i=0;for(var j=0;j<l;j++){x.push(0);y.push(0);z.push(0);g.push(T("d",j,f))}for(var j=0;j<l;j++){var n=b[j]?b[j].length:0;y[j]+=n;for(var k=0;k<n;k++){var e=b[j][k];if(e&&e.colSpan>1){for(var m=1;m<e.colSpan;m++){y[j+m]++}}}}var o="<td class='${cssclass}' axis='${axis}' ch='${ch}' abbr='${abbr}' title='${title}' ${otherAttr}>${html}</td>";for(var j=0;j<d&&i<c;j++){a.push("<tr>");for(var h=0;h<l;){var e=b[h]?b[h][x[h]]:undefined;var p={"class":"",axis:"",ch:"",title:"",abbr:"",html:"",otherAttr:"",click:"javascript:void(0);"};var q=["st-c"];if(e){x[h]=x[h]+1;var r=false;if(z[h]+1==y[h]&&e.colSpan==1){r=true}if(!r&&j==(d-1)&&z[h]<y[h]){i++;$.extend(p,{"axis":h,ch:"more","abbr":S.call(g[h],i18n.xgcalendar.dateformat.fulldayvalue),html:i18n.xgcalendar.others+(y[h]-z[h])+i18n.xgcalendar.item,click:"javascript:alert('more event');"});q.push("st-more st-moreul");h++}else{p.html=BuildMonthDayEvent(e,g[h],l-h);p.ch="show";if(e.colSpan>1){p.otherAttr=" colSpan='"+e.colSpan+"'";for(var m=0;m<e.colSpan;m++){z[h+m]=z[h+m]+1}h+=e.colSpan}else{z[h]=z[h]+1;h++}i++}}else{if(j==(d-1)&&z[h]<y[h]&&y[h]>0){$.extend(p,{"axis":h,ch:"more","abbr":S.call(g[h],i18n.xgcalendar.dateformat.fulldayvalue),html:i18n.xgcalendar.others+(y[h]-z[h])+i18n.xgcalendar.item,click:"javascript:alert('more event');"});q.push("st-more st-moreul");h++}else{$.extend(p,{html:"&nbsp;",ch:"qkadd","axis":"00:00","abbr":S.call(g[h],i18n.xgcalendar.dateformat.fulldayvalue),title:""});q.push("st-s");h++}}p.cssclass=q.join(" ");q=null;a.push(Tp(o,p));p=null}a.push("</tr>")}x=y=z=g=null}function BuildMonthDayEvent(e,a,b){var c;if(e.event[7]&&e.event[7]>=0){c=tc(e.event[7])}else{c=tc()}var p={color:c[2],title:"",extendClass:"",extendHTML:"",data:""};p.title=getTitle(e.event);p.id="bbit_cal_event_"+e.event[0];if(E.enableDrag&&e.event[8]==1){p.eclass="drag"}else{p.eclass="cal_"+e.event[0]}p.data=e.event.join("$");var d="<span style=\"cursor: pointer\">${content}</span>";var i="<I class=\"cic cic-tmr\">&nbsp;</I>";var f="<I class=\"cic cic-rcr\">&nbsp;</I>";var g="<div class=\"st-ad-ml\"></div>";var h="<div class=\"st-ad-mr\"></div>";var j=[];var k=e.event[2]<a;var l=U("d",a,e.event[3])>=b;if(k||l){if(k){j.push(g);p.extendClass="st-ad-mpad "}if(l){j.push(h)}p.extendHTML=j.join("")}var m;if(!e.allday&&!k){m=pZero(e.st.hour)+":"+pZero(e.st.minute)+" "+e.event[1]}else{m=e.event[1]}var n=[];n.push(Tp(d,{content:m}));n.push(i);if(e.reevent){n.push(f)}p.content=n.join("");return Tp(K,p)}function populate(){if(E.isloading){return true}if(E.url&&E.url!=""){E.isloading=true;if(E.onBeforeRequestData&&$.isFunction(E.onBeforeRequestData)){E.onBeforeRequestData(1)}var d=new Date().getTimezoneOffset()/60*-1;var f=[{name:"content_event_showdate",value:S.call(E.showday,i18n.xgcalendar.dateformat.fulldayvalue)},{name:"content_event_viewtype",value:E.view},{name:"content_event_timezone",value:d}];if(E.extParam){for(var g=0;g<E.extParam.length;g++){f[f.length]=E.extParam[g]}}$.ajax({type:E.method,url:E.url,data:f,dataType:"json",dataFilter:function(a,b){return a},success:function(c){if(c!=null&&c.error!=null){if(E.onRequestDataError){E.onRequestDataError(1,c)}}else{c["start"]=parseDate(c["start"]);c["end"]=parseDate(c["end"]);$.each(c.events,function(a,b){b[2]=parseDate(b[2]);b[3]=parseDate(b[3])});responseData(c,c.start,c.end);pushER(c.start,c.end)}if(E.onAfterRequestData&&$.isFunction(E.onAfterRequestData)){E.onAfterRequestData(1)}E.isloading=false},error:function(a){try{if(E.onRequestDataError){E.onRequestDataError(1,a)}else{alert(i18n.xgcalendar.get_data_exception)}if(E.onAfterRequestData&&$.isFunction(E.onAfterRequestData)){E.onAfterRequestData(1)}E.isloading=false}catch(e){}}})}else{alert("url"+i18n.xgcalendar.i_undefined)}}function responseData(a,b,c){var d;if(a.issort==false){if(a.events&&a.events.length>0){d=a.sort(function(l,r){return l[2]>r[2]?-1:1})}else{d=[]}}else{d=a.events}ConcatEvents(d,b,c);render()}function clearrepeat(a,b,c){var d=a.length;if(d>0){var e=a[0][2];var f=a[d-1][2];for(var i=0,l=E.eventItems.length;i<l;i++){if(E.eventItems[i][2]>f||d==0){break}if(E.eventItems[i][2]>=e){for(var j=0;j<d;j++){if(E.eventItems[i][0]==a[j][0]&&E.eventItems[i][2]<b){a.splice(j,1);d--;break}}}}}}function ConcatEvents(a,b,c){if(!a){a=[]}if(a){if(E.eventItems.length==0){E.eventItems=a}else{clearrepeat(a,b,c);var l=a.length;var d=E.eventItems.length;var f=-1;var g=d;var s=b;var e=c;if(E.eventItems[0][2]>e){E.eventItems=a.concat(E.eventItems);return}if(E.eventItems[d-1][2]<s){E.eventItems=E.eventItems.concat(a);return}for(var i=0;i<d;i++){if(E.eventItems[i][2]>=s&&f<0){f=i;continue}if(E.eventItems[i][2]>e){g=i;break}}var h=f<=0?[]:E.eventItems.slice(0,f);var j=g==d?[]:E.eventItems.slice(g);E.eventItems=[].concat(h,a,j);a=h=j=null}}}function weekormonthtoday(e){var a=$(this);var b=a.attr("abbr");E.showday=strtodate(b+" 00:00");E.view="day";render();if(E.onweekormonthtoday){E.onweekormonthtoday(E)}return false}function parseDate(a){return new Date(Date.parse(a))}function gP(h,m){return h*42+parseInt(m/60*42)}function gW(a,b){var c=a/42;var d=parseInt(c);var e=c-d>=0.5?30:0;var f=b/42;var g=parseInt(f);var h=f-g>=0.5?30:0;return{sh:d,sm:e,eh:g,em:h,h:b-a}}function gH(a,b,c){var d=Math.min(a,b);var e=Math.max(a,b);var f=(d-c)/42;var g=parseInt(f);var h=f-g>=0.5?30:0;var i=(e-c)/42;var j=parseInt(i);var k=i-j>=0.5?30:0;return{sh:g,sm:h,eh:j,em:k,h:e-d}}function pZero(n){return n<10?"0"+n:""+n}function tc(d){function zc(c,i){var d="666666888888aaaaaabbbbbbdddddda32929cc3333d96666e69999f0c2c2b1365fdd4477e67399eea2bbf5c7d67a367a994499b373b3cca2cce1c7e15229a36633cc8c66d9b399e6d1c2f029527a336699668cb399b3ccc2d1e12952a33366cc668cd999b3e6c2d1f01b887a22aa9959bfb391d5ccbde6e128754e32926265ad8999c9b1c2dfd00d78131096184cb05288cb8cb8e0ba52880066aa008cbf40b3d580d1e6b388880eaaaa11bfbf4dd5d588e6e6b8ab8b00d6ae00e0c240ebd780f3e7b3be6d00ee8800f2a640f7c480fadcb3b1440edd5511e6804deeaa88f5ccb8865a5aa87070be9494d4b8b8e5d4d47057708c6d8ca992a9c6b6c6ddd3dd4e5d6c6274878997a5b1bac3d0d6db5a69867083a894a2beb8c1d4d4dae54a716c5c8d8785aaa5aec6c3cedddb6e6e41898951a7a77dc4c4a8dcdccb8d6f47b08b59c4a883d8c5ace7dcce";return"#"+d.substring(c*30+i*6,c*30+(i+1)*6)}var c=d!=null&&d!=undefined?d:E.theme;return[zc(c,0),zc(c,1),zc(c,2),zc(c,3)]}function Tp(c,d){return c.replace(/\$\{([\w]+)\}/g,function(a,b){var s=d[b];if(typeof(s)!="undefined"){return s}else{return a}})}function Ta(c,d){return c.replace(/\{([\d])\}/g,function(a,b){var s=d[b];if(typeof(s)!="undefined"){return encodeURIComponent(s)}else{return""}})}function fomartTimeShow(h){return h<10?"0"+h+":00":h+":00"}function getymformat(b,c,d,e,f){var g=d!=undefined?(b.getFullYear()!=new Date().getFullYear()):true;var h=true;var i=true;var j=d||false;var k=e||false;if(c){g=c.getFullYear()!=b.getFullYear();if(c.getFullYear()==b.getFullYear()&&b.getMonth()==c.getMonth()&&b.getDate()==c.getDate()){g=h=i=k=false}}var a=[];if(g){a.push(i18n.xgcalendar.dateformat.fulldayshow)}else if(h){a.push(i18n.xgcalendar.dateformat.Md3)}else if(i){a.push(i18n.xgcalendar.dateformat.day)}a.push(k?" (W)":"",j?" HH:mm":"");return a.join("")}function CalDateShow(a,b,c,d){if(!b){return S.call(a,getymformat(a,null,c))}else{var e=S.call(a,getymformat(a,null,c,d));var f=S.call(b,getymformat(b,a,c,d));var g=(f!=""?" - ":"");return[e,f].join(g)}}function dochange(){var d=getRdate();var a=checkInEr(d.start,d.end);if(!a){populate()}}function checkInEr(a,b){var c=E.loadDateR.length;if(c==0){return false}var r=false;var d=false;for(var i=0;i<c;i++){r=false,d=false;var e=E.loadDateR[i];if(a>=e.startdate&&a<=e.enddate){r=true}if(S.call(a,"yyyyMMdd")==S.call(e.startdate,"yyyyMMdd")||S.call(a,"yyyyMMdd")==S.call(e.enddate,"yyyyMMdd")){r=true}if(!b){d=true}else{if(b>=e.startdate&&b<=e.enddate){d=true}if(S.call(b,"yyyyMMdd")==S.call(e.startdate,"yyyyMMdd")||S.call(b,"yyyyMMdd")==S.call(e.enddate,"yyyyMMdd")){d=true}}if(r&&d){break}}return r&&d}function buildtempdayevent(a,b,c,d,h,e,w,f,g){var i=g!=undefined&&g>=0?tc(g):tc();var j=Tp(J,{bdcolor:i[0],bgcolor2:i[0],bgcolor1:i[2],eventid:"",data:"",starttime:[pZero(a),pZero(b)].join(":"),endtime:[pZero(c),pZero(d)].join(":"),content:e?e:i18n.xgcalendar.new_event,title:e?e:i18n.xgcalendar.new_event,icon:"<I class=\"cic cic-tmr\">&nbsp;</I>",top:"0px",left:"",width:w?w:"100%",height:h-4,i:"-1",drag:"drag-chip",redisplay:f?"block":"none"});return j}function getdata(a){var b=a.find("div.dhdV");if(b.length==1){var c=b.text();return parseED(c.split("$"))}return null}function parseED(a){if(a.length>6){var e=[];e.push(a[0],a[1],new Date(a[2]),new Date(a[3]),parseInt(a[4]),parseInt(a[5]),parseInt(a[6]),a[7]!=undefined?parseInt(a[7]):-1,a[8]!=undefined?parseInt(a[8]):0,a[9],a[10]);return e}return null}function quickd(b){$("#bbit-cs-buddle").css("visibility","hidden");var c=$("#bbit-cs-id").val();var d=[{"name":"eventid",value:c},{"name":"type",value:b}];var e=rebyKey(c,true);E.onBeforeRequestData&&E.onBeforeRequestData(3);$.post(E.quickDeleteUrl,d,function(a){if(a){if(a.IsSuccess){e=null;E.onAfterRequestData&&E.onAfterRequestData(3)}else{E.onRequestDataError&&E.onRequestDataError(3,a);Ind(e);render();E.onAfterRequestData&&E.onAfterRequestData(3)}}},"json");render()}function getbuddlepos(x,y){var a=x-110;var b=y-217;var c=document.documentElement.clientWidth;var d=document.documentElement.clientHeight;var e=false;if(a<=0||b<=0||a+400>c){a=x-200<=0?10:x-200;b=y-159<=0?10:y-159;if(a+400>=c){a=c-410}if(b+164>=d){b=d-165}e=true}return{left:a,top:b,hide:e}}function dayshow(e,b){if(b==undefined){b=getdata($(this))}if(b!=null){if(E.quickDeleteUrl!=""&&b[8]==1&&E.readonly!=true){var c='<div id="bbit-cs-buddle" style="width: 400px;visibility:hidden;" class="bubble"><table class="bubble-table" cellSpacing="0" cellPadding="0"><tbody><tr><td class="bubble-cell-side"><div id="tl1" class="bubble-corner"><div class="bubble-sprite bubble-tl"></div></div><td class="bubble-cell-main"><div class="bubble-top"></div><td class="bubble-cell-side"><div id="tr1" class="bubble-corner"><div class="bubble-sprite bubble-tr"></div></div>  <tr><td class="bubble-mid" colSpan="3"><div style="overflow: hidden" id="bubbleContent1"><div><div></div><div class="cb-root"><table class="cb-table" cellSpacing="0" cellPadding="0"><tbody><tr><td class="cb-value"><div class="textbox-fill-wrapper"><div class="textbox-fill-mid"><div id="bbit-cs-what"class="textbox-fill-div"></div></div></div></td></tr><tr><td class=cb-value><div id="bbit-cs-buddle-timeshow"></div></td></tr></tbody></table><div class="bbit-cs-split"><input id="bbit-cs-id" type="hidden" value=""/><button type="button" id="event_preview" title="'+i18n.xgcalendar.click_to_detail+'" class="btnEventPreview"><div class="btnBgIcon"></div></button> &nbsp; <button type="button" id="bbit-cs-editLink" title="'+i18n.xgcalendar.update_detail+'" class="btnEventEdit"><div class="btnBgIcon"></div></button> &nbsp; <button type="button" id="bbit-cs-delete" title="'+i18n.xgcalendar.i_delete+'" class="btnEventDelete"><div class="btnBgIcon"></div></button></div></div></div></div><tr><td><div id="bl1" class="bubble-corner"><div class="bubble-sprite bubble-bl"></div></div><td><div class="bubble-bottom"></div><td><div id="br1" class="bubble-corner"><div class="bubble-sprite bubble-br"></div></div></tr></tbody></table><div id="bubbleClose2" class="bubble-closebutton"></div><div id="prong1" class="prong"><div class=bubble-sprite></div></div></div>';var d=$("#bbit-cs-buddle");if(d.length==0){d=$(c).appendTo(document.body);var f=$("#bbit-cs-delete");var g=$("#bbit-cs-editLink");var h=$("#bubbleClose2").click(function(){$("#bbit-cs-buddle").css("visibility","hidden")});f.click(function(){var a=$("#bbit-cs-buddle").data("cdata");if(E.DeleteCmdhandler&&$.isFunction(E.DeleteCmdhandler)){E.DeleteCmdhandler.call(this,a,quickd)}else{if(confirm(i18n.xgcalendar.confirm_delete_event+"?")){var s=0;if(a[6]==1){if(confirm(i18n.xgcalendar.confrim_delete_event_or_all)){s=0}else{s=1}}else{s=0}quickd(s)}}});$("#event_preview").click(function(e){if(!E.ViewCmdhandler){alert("ViewCmdhandler"+i18n.xgcalendar.i_undefined)}else{$("#event_preview").attr('id','event_preview_'+b[0]);getRecordPreview(this)}$("#bbit-cs-buddle").css("visibility","hidden");return false});g.click(function(e){if(!E.EditCmdhandler){alert("EditCmdhandler"+i18n.xgcalendar.i_undefined)}else{g.attr('id','event_write_'+b[0]);getRecordWrite(this,2)}$("#bbit-cs-buddle").css("visibility","hidden");return false});d.click(function(){return false})}var i=getbuddlepos(e.pageX,e.pageY);if(i.hide){$("#prong1").hide()}else{$("#prong1").show()}var j=[];var k=U("d",b[2],b[3])!=0;j.push(S.call(b[2],i18n.xgcalendar.dateformat.Md3)," (",P[b[2].getDay()],")");if(b[4]!=1){j.push(",",S.call(b[2],"HH:mm"))}if(k){j.push(" - ",S.call(b[3],i18n.xgcalendar.dateformat.Md3)," (",P[b[3].getDay()],")");if(b[4]!=1){j.push(",",S.call(b[3],"HH:mm"))}}var l=$("#bbit-cs-buddle-timeshow").html(j.join(""));$("#bbit-cs-what").html(b[1]);$("#bbit-cs-id").val(b[0]);d.data("cdata",b);d.css({"visibility":"visible",left:i.left,top:i.top});$(document).one("click",function(){$("#bbit-cs-buddle").css("visibility","hidden")})}else{if(!E.ViewCmdhandler){alert("ViewCmdhandler"+i18n.xgcalendar.i_undefined)}else{if(E.ViewCmdhandler&&$.isFunction(E.ViewCmdhandler)){E.ViewCmdhandler.call(this,b)}}}}else{alert(i18n.xgcalendar.data_format_error)}return false}function moreshow(a){var b=$(this);var c=a.id.split('_')[1];var d=$(a);var f=b.position();var g=d.position();var h=(b.width()+2)*1.5;var k=g.top+15;var l=f.left;var m=this.abbr;var n=m.split('/');var o=new Date(n[0],parseInt(n[1]-1),n[2]);var p=$("#cal-month-cc");var q=$("#cal-month-cc-content table tbody");var r=$("#cal-month-cc-title");r.html(S.call(o,i18n.xgcalendar.dateformat.Md3)+" "+P[o.getDay()]);q.empty();var s=$("#gridEvent").data("mvdata");var t=s[c];var u=parseInt(this.axis);var v=[];for(var i=0;i<=u;i++){var w=t[i]?t[i].length:0;for(var j=0;j<w;j++){var e=t[i][j];if(e){if((e.colSpan+i-1)>=u){v.push("<tr><td class='st-c'>");v.push(BuildMonthDayEvent(e,o,1));v.push("</td></tr>")}}}}q.html(v.join(""));q.find("div.rb-o").each(function(i){$(this).click(dayshow)});s=t=null;var x=p.height();var y=document.documentElement.clientWidth;var z=document.documentElement.clientHeight;if(l+h>=y){l=f.left-(b.width()+2)*0.5}if(k+x>=z){k=z-x-2}var A={left:l,top:k,"z-index":180,width:h,"visibility":"visible"};p.css(A);$(document).one("click",closeCc);return false}function dayupdate(b,c,e){if(E.quickUpdateUrl!=""&&b[8]==1&&E.readonly!=true){if(E.isloading){return false}E.isloading=true;var f=b[0];var g=b[2];var h=b[3];var i=new Date().getTimezoneOffset()/60*-1;var j=[{"name":"eventid",value:f},{"name":"content_event_date_start",value:S.call(c,i18n.xgcalendar.dateformat.fulldayvalue+" HH:mm")},{"name":"content_event_date_stop",value:S.call(e,i18n.xgcalendar.dateformat.fulldayvalue+" HH:mm")},{"name":"content_event_timezone",value:i}];var d;if(E.quickUpdateHandler&&$.isFunction(E.quickUpdateHandler)){E.quickUpdateHandler.call(this,j)}else{E.onBeforeRequestData&&E.onBeforeRequestData(4);$.post(E.quickUpdateUrl,j,function(a){if(a){if(a.IsSuccess==true){E.isloading=false;E.onAfterRequestData&&E.onAfterRequestData(4)}else{E.onRequestDataError&&E.onRequestDataError(4,a);E.isloading=false;d=rebyKey(f,true);d[2]=g;d[3]=h;Ind(d);render();d=null;E.onAfterRequestData&&E.onAfterRequestData(4)}}},"json");d=rebyKey(f,true);if(d){d[2]=c;d[3]=e}Ind(d);render()}}}function quickadd(p,q,r,s){if((!E.quickAddHandler&&E.quickAddUrl=="")||E.readonly){return}var t=$("#bbit-cal-buddle");if(t.length==0){var u=[];u.push('<div id="bbit-cal-buddle" style="width: 400px;visibility:hidden;" class="bubble">');u.push('<table class="bubble-table" cellSpacing="0" cellPadding="0"><tbody><tr><td class="bubble-cell-side"><div id="tl1" class="bubble-corner"><div class="bubble-sprite bubble-tl"></div></div>');u.push('<td class="bubble-cell-main"><div class="bubble-top"></div><td class="bubble-cell-side"><div id="tr1" class="bubble-corner"><div class="bubble-sprite bubble-tr"></div></div>  <tr><td class="bubble-mid" colSpan="3"><div style="overflow: hidden" id="bubbleContent1"><div><div></div><div class="cb-root">');u.push('<table class="cb-table" cellSpacing="0" cellPadding="0"><tbody><tr><th class="cb-key">');u.push(i18n.xgcalendar.time,':</th><td class=cb-value><div id="bbit-cal-buddle-timeshow"></div></td></tr><tr><th class="cb-key">');u.push(i18n.xgcalendar.content,':</th><td class="cb-value"><div class="textbox-fill-wrapper"><div class="textbox-fill-mid"><input id="bbit-cal-what" class="textbox-fill-input input" maxlength="100" /></div></div><div class="cb-example">');u.push(i18n.xgcalendar.example,'</div></td></tr></tbody></table><input id="bbit-cal-start" type="hidden"/><input id="bbit-cal-end" type="hidden"/><input id="bbit-cal-allday" type="hidden"/><button type="button" id="bbit-cal-quickAddBTN" title="'+i18n.xgcalendar.create_event+'" class="btnEventAdd"><div class="btnBgIcon"></div></button>');u.push('</div></div></div><tr><td><div id="bl1" class="bubble-corner"><div class="bubble-sprite bubble-bl"></div></div><td><div class="bubble-bottom"></div><td><div id="br1" class="bubble-corner"><div class="bubble-sprite bubble-br"></div></div></tr></tbody></table><div id="bubbleClose1" class="bubble-closebutton"></div><div id="prong2" class="prong"><div class=bubble-sprite></div></div></div>');var v=u.join("");u=null;$(document.body).append(v);t=$("#bbit-cal-buddle");var w=$("#bbit-cal-quickAddBTN");var x=$("#bbit-cal-editLink");var y=$("#bubbleClose1").click(function(){$("#bbit-cal-buddle").css("visibility","hidden");realsedragevent()});w.click(function(e){if(E.isloading){return false}E.isloading=true;var b=$("#bbit-cal-what").val();var c=$("#bbit-cal-start").val();var d=$("#bbit-cal-end").val();var g=$("#bbit-cal-allday").val();var f=/^[^\$\<\>]+$/.test(b);if(!f){alert(i18n.xgcalendar.invalid_title);$("#bbit-cal-what").focus();E.isloading=false;return false}var h=new Date().getTimezoneOffset()/60*-1;var i=[{"name":"content_title",value:b},{"name":"content_event_date_start",value:c},{"name":"content_event_date_stop",value:d},{"name":"content_event_allday",value:g},{"name":"content_event_timezone",value:h}];if(E.extParam){for(var j=0;j<E.extParam.length;j++){i[i.length]=E.extParam[j]}}if(E.quickAddHandler&&$.isFunction(E.quickAddHandler)){E.quickAddHandler.call(this,i);$("#bbit-cal-buddle").css("visibility","hidden");realsedragevent()}else{$("#bbit-cal-buddle").css("visibility","hidden");var k=[];var l=-1;E.onBeforeRequestData&&E.onBeforeRequestData(2);$.post(E.quickAddUrl,i,function(a){if(a){if(a.IsSuccess==true){E.isloading=false;E.eventItems[l][0]=a.Data;E.eventItems[l][8]=1;render();E.onAfterRequestData&&E.onAfterRequestData(2)}else{E.onRequestDataError&&E.onRequestDataError(2,a);E.isloading=false;E.onAfterRequestData&&E.onAfterRequestData(2)}}},"json");k.push(-1,b);var m=strtodate(c);var n=strtodate(d);var o=U("d",m,n);k.push(m,n,g=="1"?1:0,o>0?1:0,0);k.push(-1,0,"","");l=Ind(k);realsedragevent();render()}});x.click(function(e){if(!E.EditCmdhandler){alert("EditCmdhandler"+i18n.xgcalendar.i_undefined)}else{x.attr('id','event_write_'+data[0]);getRecordWrite(this,2);$("#bbit-cal-buddle").css("visibility","hidden");realsedragevent()}return false});t.mousedown(function(e){return false})}var z=CalDateShow(p,q,!r,true);var A=getbuddlepos(s.left,s.top);if(A.hide){$("#prong2").hide()}else{$("#prong2").show()}$("#bbit-cal-buddle-timeshow").html(z);var B=$("#bbit-cal-what").val("");$("#bbit-cal-allday").val(r?"1":"0");$("#bbit-cal-start").val(S.call(p,i18n.xgcalendar.dateformat.fulldayvalue+" HH:mm"));$("#bbit-cal-end").val(S.call(q,i18n.xgcalendar.dateformat.fulldayvalue+" HH:mm"));t.css({"visibility":"visible",left:A.left,top:A.top});B.blur().focus();$(document).one("mousedown",function(){$("#bbit-cal-buddle").css("visibility","hidden");realsedragevent()});return false}function strtodate(a){var b=a.split(" ");var c=b[0].split(i18n.xgcalendar.dateformat.separator);var e=b[1].split(":");var y=c[i18n.xgcalendar.dateformat.year_index];var m=c[i18n.xgcalendar.dateformat.month_index].indexOf("0")==0?c[i18n.xgcalendar.dateformat.month_index].substr(1,1):c[i18n.xgcalendar.dateformat.month_index];var d=c[i18n.xgcalendar.dateformat.day_index].indexOf("0")==0?c[i18n.xgcalendar.dateformat.day_index].substr(1,1):c[i18n.xgcalendar.dateformat.day_index];var h=e[0].indexOf("0")==0?e[0].substr(1,1):e[0];var n=e[1].indexOf("0")==0?e[1].substr(1,1):e[1];return new Date(y,parseInt(m)-1,d,h,n)}function rebyKey(a,b){if(E.eventItems&&E.eventItems.length>0){var c=E.eventItems.length;var i=-1;for(var j=0;j<c;j++){if(E.eventItems[j][0]==a){i=j;break}}if(i>=0){var t=E.eventItems[i];if(b){E.eventItems.splice(i,1)}return t}}return null}function Ind(a,i){var d=0;if(!i){if(E.eventItems&&E.eventItems.length>0){var b=E.eventItems.length;var s=a[2];var c=s.getTime()-E.eventItems[0][2].getTime();var e=E.eventItems[b-1][2].getTime()-s.getTime();var f=c-e;if(c<0||f<0){for(var j=0;j<b;j++){if(E.eventItems[j][2]>=s){i=j;break}}}else if(e<0){i=b}else{for(var j=b-1;j>=0;j--){if(E.eventItems[j][2]<s){i=j+1;break}}}}else{i=0}}else{d=1}if(E.eventItems&&E.eventItems.length>0){if(i==E.eventItems.length){E.eventItems.push(a)}else{E.eventItems.splice(i,d,a)}}else{E.eventItems=[a]}return i}function ResizeView(){var a=document.documentElement.clientHeight;var b=E.view;if(b=="day"||b=="week"){var c=$("#dvwkcontaienr");var d=$("#dvtec");if(c.length==0||d.length==0){alert(i18n.xgcalendar.view_no_ready);return}var e=c.height()+2;var f=E.height-8-e;d.height(f);if(typeof(E.scoll)=="undefined"){var g=new Date();var h=g.getHours();var m=g.getMinutes();var i=gP(h,m);var j=d.attr("clientHeight");var k=i-0.5*j;var l=d.attr("scrollHeight");if(k<0)k=0;if(k>l-j)k=l-j-10*(23-h);d.attr("scrollTop",k)}else{d.attr("scrollTop",E.scoll)}}else if(b=="month"){}}function returnfalse(){return false}function initevents(b){if(b=="week"||b=="day"){$("div.chip",I).each(function(i){var a=$(this);a.click(dayshow);if(a.hasClass("drag")){a.mousedown(function(e){dragStart.call(this,"dw3",e);return false});a.find("div.resizer").mousedown(function(e){dragStart.call($(this).parent().parent(),"dw4",e);return false})}else{a.mousedown(returnfalse)}});$("div.rb-o",I).each(function(i){var a=$(this);a.click(dayshow);if(a.hasClass("drag")&&b=="week"){a.mousedown(function(e){dragStart.call(this,"dw5",e);return false})}else{a.mousedown(returnfalse)}});if(E.readonly==false){$("td.tg-col",I).each(function(i){$(this).mousedown(function(e){dragStart.call(this,"dw1",e);return false})});$("#weekViewAllDaywk").mousedown(function(e){dragStart.call(this,"dw2",e);return false})}if(b=="week"){$("#dvwkcontaienr th.gcweekname").each(function(i){$(this).click(weekormonthtoday)})}}else if(b="month"){$("div.rb-o",I).each(function(i){var a=$(this);a.click(dayshow);if(a.hasClass("drag")){a.mousedown(function(e){dragStart.call(this,"m2",e);return false})}else{a.mousedown(returnfalse)}});$("td.st-more",I).each(function(i){$(this).click(function(e){moreshow.call(this,$(this).parent().parent().parent().parent()[0]);return false}).mousedown(function(){return false})});if(E.readonly==false){$("#mvEventContainer").mousedown(function(e){dragStart.call(this,"m1",e);return false})}}}function realsedragevent(){if(O){O();O=null}}function dragStart(a,e){var b=$(this);var c=e.srcElement||e.target;realsedragevent();switch(a){case"dw1":N={type:1,target:b,sx:e.pageX,sy:e.pageY};break;case"dw2":var w=b.width();var h=b.height();var d=b.offset();var f=d.left;var g=d.top;var l=E.view=="day"?1:7;var j=w%l;var k=parseInt(w/l);if(j>l/2+1){k++}var m=[];var n=[];for(var i=0;i<l;i++){m.push({s:i*k+f,e:(i+1)*k+f})}n.push({s:g,e:g+h});N={type:2,target:b,sx:e.pageX,sy:e.pageY,pw:k,xa:m,ya:n,h:h};w=f=l=j=k=m=null;break;case"dw3":var o=b.parent().attr("id").replace("tgCol","");var p=b.parent();var q=p.offset();var w=p.width()+10;var h=b.height();var r=getdata(b);N={type:4,target:b,sx:e.pageX,sy:e.pageY,pXMin:q.left,pXMax:q.left+w,pw:w,h:h,cdi:parseInt(o),fdi:parseInt(o),data:r};break;case"dw4":var h=b.height();var r=getdata(b);N={type:5,target:b,sx:e.pageX,sy:e.pageY,h:h,data:r};break;case"dw5":var s=$("#weekViewAllDaywk");var w=s.width();var h=s.height();var d=s.offset();var t=b.offset();var f=d.left;var g=d.top;var l=7;var j=w%l;var k=parseInt(w/l);if(j>l/2+1){k++}var m=[];var n=[];var u=0;for(var i=0;i<l;i++){m.push({s:i*k+f,e:(i+1)*k+f});if(t.left>=m[i].s&&t.left<m[i].e){u=i}}var v={x:u,y:0,di:u};n.push({s:g,e:g+h});var r=getdata(b);var x=U("d",r[2],r[3])+1;N={type:6,target:b,sx:e.pageX,sy:e.pageY,data:r,xa:m,ya:n,fdi:v,h:h,dp:x,pw:k};break;case"m1":var w=b.width();var d=b.offset();var f=d.left;var g=d.top;var l=7;var y=b.children().length;var j=w%l;var k=parseInt(w/l);if(j>l/2+1){k++}var h=$("#mvrow_0").height();var m=[];var n=[];for(var i=0;i<l;i++){m.push({s:i*k+f,e:(i+1)*k+f})}var m=[];var n=[];for(var i=0;i<l;i++){m.push({s:i*k+f,e:(i+1)*k+f})}for(var i=0;i<y;i++){n.push({s:i*h+g,e:(i+1)*h+g})}N={type:3,target:b,sx:e.pageX,sy:e.pageY,pw:k,xa:m,ya:n,h:h};break;case"m2":var z=$("#mvrow_0");var A=$("#mvrow_1");var w=z.width();var d=z.offset();var B=A.offset();var t=b.offset();var h=B.top-d.top;var f=d.left;var g=d.top;var l=7;var y=z.parent().children().length;var j=w%l;var k=parseInt(w/l);if(j>l/2+1){k++}var m=[];var n=[];var C=0;var D=0;for(var i=0;i<l;i++){m.push({s:i*k+f,e:(i+1)*k+f});if(t.left>=m[i].s&&t.left<m[i].e){C=i}}for(var i=0;i<y;i++){n.push({s:i*h+g,e:(i+1)*h+g});if(t.top>=n[i].s&&t.top<n[i].e){D=i}}var v={x:C,y:D,di:D*7+C};var r=getdata(b);var x=U("d",r[2],r[3])+1;N={type:7,target:b,sx:e.pageX,sy:e.pageY,data:r,xa:m,ya:n,fdi:v,h:h,dp:x,pw:k};break}$('body').noSelect()}function dragMove(e){if(N){if(e.pageX<0||e.pageY<0||e.pageX>document.documentElement.clientWidth||e.pageY>=document.documentElement.clientHeight){dragEnd(e);return false}var d=N;switch(d.type){case 1:var a=d.sy;var y=e.pageY;var b=y-a;if(b>11||b<-11||d.cpwrap){if(b==0){b=21}var c=b%21;if(c!=0){b=c>0?b+21-c:b-21-c;y=d.sy+b;if(b<0){a=a+21}}if(!d.tp){d.tp=$(d.target).offset().top}var f=gH(a,y,d.tp);var g=gP(f.sh,f.sm);var h;if(!d.cpwrap){h=buildtempdayevent(f.sh,f.sm,f.eh,f.em,f.h);var i=$("<div class='ca-evpi drag-chip-wrapper' style='top:"+g+"px'/>").html(h);$(d.target).find("div.tg-col-overlaywrapper").append(i);d.cpwrap=i}else{if(d.cgh.sh!=f.sh||d.cgh.eh!=f.eh||d.cgh.sm!=f.sm||d.cgh.em!=f.em){h=buildtempdayevent(f.sh,f.sm,f.eh,f.em,f.h);d.cpwrap.css("top",g+"px").html(h)}}d.cgh=f}break;case 2:var j=d.sx;var x=e.pageX;var k=x-j;if(k>5||k<-5||d.lasso){if(!d.lasso){d.lasso=$("<div style='z-index: 0; display: block' class='drag-lasso-container'/>");$(document.body).append(d.lasso)}if(!d.sdi){d.sdi=getdi(d.xa,d.ya,j,d.sy)}var l=getdi(d.xa,d.ya,x,e.pageY);if(!d.fdi||d.fdi.di!=l.di){addlasso(d.lasso,d.sdi,l,d.xa,d.ya,d.h)}d.fdi=l}break;case 3:var j=d.sx;var x=e.pageX;var a=d.sy;var y=e.pageY;var k=x-j;var b=y-a;if(k>5||k<-5||b<-5||b>5||d.lasso){if(!d.lasso){d.lasso=$("<div style='z-index: 0; display: block' class='drag-lasso-container'/>");$(document.body).append(d.lasso)}if(!d.sdi){d.sdi=getdi(d.xa,d.ya,j,a)}var l=getdi(d.xa,d.ya,x,y);if(!d.fdi||d.fdi.di!=l.di){addlasso(d.lasso,d.sdi,l,d.xa,d.ya,d.h)}d.fdi=l}break;case 4:var m=d.data;if(m!=null&&m[8]==1){var j=d.sx;var x=e.pageX;var a=d.sy;var y=e.pageY;var k=x-j;var b=y-a;if(k>5||k<-5||b>5||b<-5||d.cpwrap){var f,g,h;if(!d.cpwrap){f={sh:m[2].getHours(),sm:m[2].getMinutes(),eh:m[3].getHours(),em:m[3].getMinutes(),h:d.h};d.target.hide();g=gP(f.sh,f.sm);d.top=g;h=buildtempdayevent(f.sh,f.sm,f.eh,f.em,f.h,m[1],false,false,m[7]);var i=$("<div class='ca-evpi drag-chip-wrapper' style='top:"+g+"px'/>").html(h);var n=d.target.parent().attr("id").replace("tgCol","#tgOver");$(n).append(i);d.cpwrap=i;d.ny=g}else{var o=0;if(x<d.pXMin){o=-1}else if(x>d.pXMax){o=1}if(o!=0){d.cdi=d.cdi+o;var p=$("#tgOver"+d.cdi);if(p.length==1){d.pXMin=d.pXMin+d.pw*o;d.pXMax=d.pXMax+d.pw*o;p.append(d.cpwrap)}else{d.cdi=d.cdi-o}}g=d.top+b;var q=g%21;if(q!=0){g=g-q}if(d.ny!=g){f=gW(g,g+d.h);h=buildtempdayevent(f.sh,f.sm,f.eh,f.em,f.h,m[1],false,false,m[7]);d.cpwrap.css("top",g+"px").html(h)}d.ny=g}}}break;case 5:var m=d.data;if(m!=null&&m[8]==1){var a=d.sy;var y=e.pageY;var b=y-a;if(b!=0||d.cpwrap){var f,g,h;if(!d.cpwrap){f={sh:m[2].getHours(),sm:m[2].getMinutes(),eh:m[3].getHours(),em:m[3].getMinutes(),h:d.h};d.target.hide();g=gP(f.sh,f.sm);d.top=g;h=buildtempdayevent(f.sh,f.sm,f.eh,f.em,f.h,m[1],"100%",true,m[7]);var i=$("<div class='ca-evpi drag-chip-wrapper' style='top:"+g+"px'/>").html(h);var n=d.target.parent().attr("id").replace("tgCol","#tgOver");$(n).append(i);d.cpwrap=i}else{nh=d.h+b;var r=nh%21;nh=r>1?nh-r+21:nh-r;if(d.nh!=nh){var s=gP(m[2].getHours(),m[2].getMinutes());var t=s+nh;f=gW(d.top,d.top+nh);h=buildtempdayevent(f.sh,f.sm,f.eh,f.em,f.h,m[1],"100%",true,m[7]);d.cpwrap.html(h)}d.nh=nh}}}break;case 6:var j=d.sx;var x=e.pageX;var y=e.pageY;var k=x-j;if(k>5||k<-5||d.lasso){if(!d.lasso){var u=d.dp>1?(d.pw-4)*1.5:(d.pw-4);var v=d.target.clone();if(d.dp>1){v.find("div.rb-i>span").prepend("("+d.dp+" "+i18n.xgcalendar.day_plural+")&nbsp;")}var i=$("<div class='drag-event st-contents' style='width:"+u+"px'/>").append(v).appendTo(document.body);d.cpwrap=i;d.lasso=$("<div style='z-index: 0; display: block' class='drag-lasso-container'/>");$(document.body).append(d.lasso);v=i=null}fixcppostion(d.cpwrap,e,d.xa,d.ya);var l=getdi(d.xa,d.ya,x,e.pageY);if(!d.cdi||d.cdi.di!=l.di){addlasso(d.lasso,l,{x:l.x,y:l.y,di:l.di+d.dp-1},d.xa,d.ya,d.h)}d.cdi=l}break;case 7:var j=d.sx;var a=d.sy;var x=e.pageX;var y=e.pageY;var k=x-j;var b=y-a;if(k>5||k<-5||b>5||b<-5||d.lasso){if(!d.lasso){var u=d.dp>1?(d.pw-4)*1.5:(d.pw-4);var v=d.target.clone();if(d.dp>1){v.find("div.rb-i>span").prepend("("+d.dp+" "+i18n.xgcalendar.day_plural+")&nbsp;")}var i=$("<div class='drag-event st-contents' style='width:"+u+"px'/>").append(v).appendTo(document.body);d.cpwrap=i;d.lasso=$("<div style='z-index: 0; display: block' class='drag-lasso-container'/>");$(document.body).append(d.lasso);v=i=null}fixcppostion(d.cpwrap,e,d.xa,d.ya);var l=getdi(d.xa,d.ya,x,e.pageY);if(!d.cdi||d.cdi.di!=l.di){addlasso(d.lasso,l,{x:l.x,y:l.y,di:l.di+d.dp-1},d.xa,d.ya,d.h)}d.cdi=l}break}}return false}function dragEnd(e){if(N){var d=N;switch(d.type){case 1:var a=new Date().getTime();tp=d.target.offset().top;if(!d.cpwrap){var b=gH(d.sy,d.sy+42,tp);var c=gP(b.sh,b.sm);var f=buildtempdayevent(b.sh,b.sm,b.eh,b.em,b.h);d.cpwrap=$("<div class='ca-evpi drag-chip-wrapper' style='top:"+c+"px'/>").html(f);$(d.target).find("div.tg-col-overlaywrapper").append(d.cpwrap);d.cgh=b}var g=d.cpwrap.offset();g.left=g.left+30;d.cpwrap.attr("id",a);var h=strtodate(d.target.attr("abbr")+" "+d.cgh.sh+":"+d.cgh.sm);var i=strtodate(d.target.attr("abbr")+" "+d.cgh.eh+":"+d.cgh.em);O=function(){$("#"+a).remove();$("#bbit-cal-buddle").css("visibility","hidden")};quickadd(h,i,false,g);break;case 2:case 3:var j=e.srcElement||e.target;var k=new Date().getTime();if(!d.lasso){if($(j).hasClass("monthdayshow")){weekormonthtoday.call($(j).parent()[0],e);break}d.fdi=d.sdi=getdi(d.xa,d.ya,d.sx,d.sy);d.lasso=$("<div style='z-index: 0; display: block' class='drag-lasso-container'/>");$(document.body).append(d.lasso);addlasso(d.lasso,d.sdi,d.fdi,d.xa,d.ya,d.h)}d.lasso.attr("id",k);var l=Math.min(d.fdi.di,d.sdi.di);var m=Math.max(d.fdi.di,d.sdi.di);var n=E.vstart;var h=T("d",l,n);var i=T("d",m,n);O=function(){$("#"+k).remove()};quickadd(h,i,true,{left:e.pageX,top:e.pageY});break;case 4:if(d.cpwrap){var h=T("d",d.cdi,E.vstart);var i=T("d",d.cdi,E.vstart);var b=gW(d.ny,d.ny+d.h);h.setHours(b.sh,b.sm);i.setHours(b.eh,b.em);if(h.getTime()==d.data[2].getTime()&&i.getTime()==d.data[3].getTime()){d.cpwrap.remove();d.target.show()}else{dayupdate(d.data,h,i)}}break;case 5:if(d.cpwrap){var h=new Date(d.data[2].toString());var i=new Date(d.data[3].toString());var b=gW(d.top,d.top+nh);h.setHours(b.sh,b.sm);i.setHours(b.eh,b.em);if(h.getTime()==d.data[2].getTime()&&i.getTime()==d.data[3].getTime()){d.cpwrap.remove();d.target.show()}else{dayupdate(d.data,h,i)}}break;case 6:case 7:if(d.lasso){d.cpwrap.remove();d.lasso.remove();var h=new Date(d.data[2].toString());var i=new Date(d.data[3].toString());var o=T("d",d.cdi.di,E.vstart);var p=U("d",h,o);h=T("d",p,h);i=T("d",p,i);if(h.getTime()!=d.data[2].getTime()||i.getTime()!=d.data[3].getTime()){dayupdate(d.data,h,i)}}break}d=N=null;$('body').noSelect(false);return false}}function getdi(a,b,x,y){var c=0;var d=0;var e=0;var f=0;if(a&&a.length!=0){e=a.length;if(x>=a[e-1].e){d=e-1}else{for(var i=0;i<e;i++){if(x>a[i].s&&x<=a[i].e){d=i;break}}}}if(b&&b.length!=0){f=b.length;if(y>=b[f-1].e){c=f-1}else{for(var j=0;j<f;j++){if(y>b[j].s&&y<=b[j].e){c=j;break}}}}return{x:d,y:c,di:c*e+d}}function addlasso(a,b,c,e,f,g){var k=b.di>c.di?b.di-c.di:c.di-b.di;k++;var m=b.di>c.di?c:b;var n=b.di>c.di?b:c;var l=e.length>0?e.length:1;var h=f.length>0?f.length:1;var o=[];var p=e[0].e-e[0].s;var i=m.x;var j=m.y;var q=Math.min(document.documentElement.clientWidth,e[l-1].e)-2;while(j<h&&k>0){var r=e[i].s;var d=i+k>l?l-i:k;var s=p*d;while(r+s>=q){s--}o.push(Tp(M,{left:r,top:f[j].s,height:g,width:s}));i=0;k=k-d;j++}a.html(o.join(""))}function fixcppostion(a,e,b,c){var x=e.pageX-6;var y=e.pageY-4;var w=a.width();var h=21;var d=b[0].s+6;var f=c[0].s+4;var g=b[b.length-1].e-w-2;var i=c[c.length-1].e-h-2;if(x>g){x=g}if(x<=d){x=d+1}if(y<=f){y=f+1}if(y>i){y=i}a.css({left:x,top:y})}$(document).mousemove(dragMove).mouseup(dragEnd);var c={sv:function(a){if(a==E.view){return}clearcontainer();E.view=a;render();dochange()},rf:function(){populate()},gt:function(d){if(!d){d=new Date()}E.showday=d;render();dochange()},pv:function(){switch(E.view){case"day":E.showday=T("d",-1,E.showday);break;case"week":E.showday=T("w",-1,E.showday);break;case"month":E.showday=T("m",-1,E.showday);break}render();dochange()},nt:function(){switch(E.view){case"day":E.showday=T("d",1,E.showday);break;case"week":E.showday=T("w",1,E.showday);break;case"month":var a=E.showday.getDate();E.showday=T("m",1,E.showday);var b=E.showday.getDate();if(a!=b){E.showday=T("d",0-b,E.showday)}break}render();dochange()},go:function(){return E},so:function(p){E=$.extend(E,p)}};this[0].bcal=c;return this};$.fn.switchView=function(a){return this.each(function(){if(this.bcal){this.bcal.sv(a)}})};$.fn.reload=function(){return this.each(function(){if(this.bcal){this.bcal.rf()}})};$.fn.gotoDate=function(d){return this.each(function(){if(this.bcal){this.bcal.gt(d)}})};$.fn.previousRange=function(){return this.each(function(){if(this.bcal){this.bcal.pv()}})};$.fn.nextRange=function(){return this.each(function(){if(this.bcal){this.bcal.nt()}})};$.fn.BcalGetOp=function(){if(this[0].bcal){return this[0].bcal.go()}return null};$.fn.BcalSetOp=function(p){if(this[0].bcal){return this[0].bcal.so(p)}}})(jQuery);
